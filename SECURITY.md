# Security Policy

## Supported Versions

| Version | Supported          |
| ------- | ------------------ |
| 1.x     | :white_check_mark: |
| < 1.0   | :x:                |

## Reporting a Vulnerability

We take security seriously. If you discover a security vulnerability in Blackpaw, please report it responsibly.

### How to Report

**Please DO NOT report security vulnerabilities through public GitHub issues.**

Instead, please report them via email to the maintainers or through GitHub's private vulnerability reporting feature:

1. Go to the repository's **Security** tab
2. Click **Report a vulnerability**
3. Fill out the form with details about the vulnerability

### What to Include

When reporting a vulnerability, please include:

- **Description**: A clear description of the vulnerability
- **Impact**: What an attacker could achieve by exploiting it
- **Reproduction Steps**: Step-by-step instructions to reproduce the issue
- **Affected Versions**: Which versions are affected (if known)
- **Suggested Fix**: If you have ideas on how to fix it (optional)

### What to Expect

- **Acknowledgment**: We will acknowledge receipt within 48 hours
- **Initial Assessment**: We will provide an initial assessment within 7 days
- **Resolution Timeline**: We aim to resolve critical vulnerabilities within 30 days
- **Credit**: We will credit you in the release notes (unless you prefer to remain anonymous)

## Security Considerations for Users

### Configuration File Security

Blackpaw configuration files (`config.json`) may contain sensitive information:

- **SQL Server connection strings** with credentials
- **Database file paths** that may reveal system structure

**Best Practices:**

1. **Never commit `config.json` to version control** - it's excluded in `.gitignore` by default
2. **Use Windows Integrated Security** (`Integrated Security=true`) instead of username/password authentication
3. **Use read-only SQL accounts** for DMV sampling when possible
4. **Store config files with restricted permissions** (readable only by the user running Blackpaw)

```json
// GOOD: Uses Integrated Security
"SqlConnectionString": "Server=localhost;Database=master;Integrated Security=true;TrustServerCertificate=true;"

// AVOID: Credentials in connection string
"SqlConnectionString": "Server=localhost;Database=master;User Id=sa;Password=secret;"
```

### Database File Security

SQLite databases (`*.db`) created by Blackpaw contain performance telemetry that may include:

- Process names and command-line arguments
- HTTP endpoint URLs and response codes
- SQL query patterns (if SQL monitoring is enabled)
- System resource utilization
- Machine hostname and hardware information

**Best Practices:**

1. **Do not share database files** without reviewing their contents
2. **Store databases in protected directories**
3. **Regularly clean up old database files**
4. Database files are excluded from version control by default

### Report Security

HTML reports generated by Blackpaw may contain:

- HTTP endpoint URLs
- Database connection information (sanitized, but server names visible)
- Process names and system information

**Best Practices:**

1. **Review reports before sharing** with external parties
2. **Redact sensitive URLs** if sharing reports publicly

### Running with Least Privilege

While Blackpaw recommends administrator access for full functionality, consider:

1. **Use a dedicated service account** with minimal permissions
2. **Grant only necessary Performance Counter access**
3. **Use read-only database connections** for SQL Server monitoring

## Known Security Limitations

1. **No Encryption at Rest**: SQLite databases are not encrypted. Use OS-level encryption (BitLocker, etc.) if needed.
2. **No Authentication**: Blackpaw CLI has no built-in authentication - rely on OS-level access controls.
3. **EventPipe Access**: Requires appropriate permissions to attach to target processes.

## Security Updates

Security updates will be released as patch versions (e.g., 1.0.1) and announced through:

- GitHub Releases
- Security Advisories (for critical issues)

We recommend always running the latest version.
